extends Reference

var skills = {
	strafe = {
		code = 'strafe',
		descript = '',
		icon = "res://assets/images/iconsskills/heavyshot.png",
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage'],
		reqs = [{code = 'gear_equiped', param = 'geartype', value = 'bow', check = true}],
		targetreqs = [],
		effects = [], 
		cost = {mp = 3},
		repeat = 3,
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_ANY,
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'weapon',
		random_target = true,
		not_final = true,
		sfx = [{code = 'strafe', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'bow', hit = null},
		value = 0.45,
		random_factor_p = 0.1,
	},
	trap = {#enemy debuff: after using skill stun target for 2 turns and remove debuff. Requires trap
		code = 'trap',
		descript = '',
		icon = "res://assets/images/iconsskills/Trap.png",
		type = 'combat', 
		ability_type = 'skill',
		tags = ['debuff'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_t_trap'})], 
		cost = {mp = 1},
		charges = 0,
		combatcooldown = 2,
		cooldown = 0,
		catalysts = {trap = 1},
		critchance = 0,
		target = 'enemy',
		target_number = 'line',
		target_range = 'melee',
		damage_type = 'weapon',
		sfx = [{code = 'trap_cast', target = 'target', period = 'predamage'}],
		sound = [],
		value = [['0']],
		damagestat = 'no_stat'
	},
	ensnare = {
		code = 'ensnare',
		descript = '',
		icon = "res://assets/images/iconsskills/skill_ensnare.png",
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [{code = 'gear_equiped', param = 'geartype', value = 'bow', check = true}],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_ensnare', duration = 1})],
		cost = {mp = 6},
		charges = 0,
		combatcooldown = 2,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'line',
		target_range = 'any',
		damage_type = 'weapon',
		sfx = [{code = 'ensnare', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'bow', hit = null},
		value = 0.5,
	},
	bolt_trap = {
		code = 'bolt_trap',
		descript = '',
		icon = "res://assets/images/iconsskills/skill_bolt_trap.png",
		type = 'combat', 
		ability_type = 'skill',
		tags = ['debuff'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_t_bolttrap', push_value = true})], 
		cost = {mp = 4},
		charges = 0,
		combatcooldown = 2,
		cooldown = 0,
		catalysts = {trap = 1},
		critchance = 0,
		target = 'enemy',
		target_number = 'line',
		target_range = 'melee',
		damage_type = 'weapon',
		sfx = [{code = 'trap_cast', target = 'target', period = 'predamage'}],
		sound = [],
		value = [['caster.atk', '*1.5']],
		damagestat = 'no_stat'
	},
	arrow_hail = {
		code = 'arrow_hail',
		descript = '',
		icon = "res://assets/images/iconsskills/arrowshower.png",
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage', 'aoe'],
		reqs = [{code = 'gear_equiped', param = 'geartype', value = 'bow', check = true}],
		targetreqs = [],
		effects = [], 
		cost = {mp = 10},
		charges = 0,
		combatcooldown = 1,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'all',
		target_range = 'any',
		damage_type = 'weapon',
		aipatterns = ['attack'],
		allowedtargets = ['enemy'],
		value = 1.2,
		random_factor_p = 0.1,
		sfx = [{code = 'arrowhail', target = 'target_group', period = 'windup'}], 
		sounddata = {initiate = null, strike = 'bow', hit = null},
	},
}
var effects = {
	e_t_trap = {
		type = 'temp_s',
		target = 'target',
		rem_event = [variables.TR_COMBAT_F, variables.TR_DEATH, variables.TR_SKILL_FINISH],
		stack = 'trap_debuff',
		buffs = ['b_trap'],
		sub_effects = ['e_tr_trap']
	},
	e_tr_trap = {
		type = 'trigger',
		target = 'target',
		trigger = [variables.TR_CAST],
		req_skill = false,
		conditions = [{type = 'random', value = 0.5}],
		atomic = [],
		buffs = [],
		sub_effects = ['e_trap', {
			type = 'oneshot',
			target = 'owner',
			atomic = [{type = 'sfx', value = 'trap'}]
		}]
	},
	e_trap = { #shoud be actual stun
		type = 'temp_s',
		target = 'owner',
		stack = 'stun',
		tick_event = variables.TR_TURN_F,
		rem_event = [variables.TR_COMBAT_F, variables.TR_DEATH],
		duration = 2,
		tags = ['stun', 'disable'],
		buffs = ['b_stun'],
	},
	
	e_t_bolttrap = {
		type = 'temp_s',
		target = 'target',
		rem_event = [variables.TR_COMBAT_F, variables.TR_DEATH, variables.TR_SKILL_FINISH],
		atomic = [],
		args = {damage = {obj = 'skill', func = 'get', arg = 'process_value'},},
		stack = 'bolttrap_debuff',
		buffs = ['b_bolttrap'],
		sub_effects = ['e_tr_bolttrap']
	},
	e_tr_bolttrap = {
		type = 'trigger',
		target = 'target',
		trigger = [variables.TR_CAST],
		req_skill = false,
		conditions = [{type = 'random', value = 0.5}],
		args = {damage = {obj = 'parent', func = 'arg', arg = 'damage'}},
		atomic = [],
		buffs = [],
		sub_effects = [{
			type = 'oneshot',
			target = 'owner',
			args = {
				value = {obj = 'parent', func = 'arg', arg = 'damage'},
				src = {obj = 'self', func = 'src', src = 'normal'},
				},
			atomic = [{type = 'sfx', value = 'bolt_trap'}, 'a_damage_simple']
		}],
	},
}
var atomic_effects = {}
var buffs = {
	b_trap = {
		icon = "res://assets/images/iconsskills/Trap.png",
		description = "BUFFDESCRIPTTRAP",
		limit = 1,
		t_name = 'trap'
	},
	b_bolttrap = {
		icon = "res://assets/images/iconsskills/skill_bolt_trap.png",
		description = "BUFFDESCRIPTBOLTTRAP",
		limit = 1,
		t_name = 'bolt_trap'
	},
}

var stacks = {
	trap_debuff = {}, #st 1
	bolttrap_debuff = {}, #st 1
}
