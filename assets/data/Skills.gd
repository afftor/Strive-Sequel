extends Node

#var professions = load("res://assets/data/classes.gd").new().professions

#example of value reqs
#		value_caster_reqs = {1:[{code = 'is_master', check = false}]},
#		value_target_reqs = {0:[{code = 'stat', stat = 'sex', value = 'male', operant = 'eq'}]},
#sample rec req 
#		value_receiver_reqs = {1:[{code = 'is_master', check = false}]}
var Skilllist = {
	#Combat Skills
	#attack
	#ranged_attack
	attack = {
		code = 'attack',
		descript = '',
		icon = load("res://assets/images/iconsskills/defaultattack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage', 'default', 'basic'],
		reqs = [],
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'weapon',
		aipatterns = ['attack'],
		allowedtargets = ['enemy'],
		value = 1,
		random_factor_p = 0.1,
		sfx = [{code = 'weapon', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
	},
	ranged_attack = {
		code = 'ranged_attack',
		descript = '',
		icon = load("res://assets/images/iconsskills/heavyshot.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage', 'default', 'basic'],
		reqs = [],#need req 
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'weapon',
		aipatterns = ['attack'],
		allowedtargets = ['enemy'],
		value = 1,
		sfx = [{code = 'ranged_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
	},
	
	enemy_slash = {#melee attack vs all enemeis in row
		code = 'enemy_slash',
		descript = '',
		icon = load("res://assets/images/iconsskills/slash.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','aoe'],
		reqs = [],
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 3,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'row',#not sure
		target_range = 'melee',
		damage_type = 'weapon',
		value = 1,#i think so
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
	},
	
	assassinate_en = {#deals 200% damage, only npc
		code = 'assassinate_en',
		descript = '',
		icon = load('res://assets/images/iconsskills/assassinate.png'),
		type = 'combat', 
		ability_type = 'skill',
		reqs = [],
		tags = ['damage','ads'],
#		new_syntax = true,
		targetreqs = [],
		effects = [], 
		cost = {mp = 0},
		charges = 3,
		combatcooldown = 0,
		cooldown = 1,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'dark',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = ['caster.atk', '*2.0']
	},
	earth_atk = {
		code = 'earth_atk',
		descript = '',
		icon = load("res://assets/images/iconsskills/icon_earth.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads','learnable'],
#		new_syntax = true,
		learn_reqs = [{code = 'trait', trait = 'basic_combat', check = true}],
		learn_cost = 200,
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_stun', chance = 0.3, checkres = 'stun'})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'earth',
		sfx = [{code = 'earth_spike', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = 'avalanche', strike = null, hit = null, hittype = 'bodyarmor'},
		value = 1.25
	},
	wind_atk = {
		code = 'wind_atk',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/windblade.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads','learnable'],
#		new_syntax = true,
		learn_reqs = [{code = 'trait', trait = 'basic_combat', check = true}],
		learn_cost = 150,
		reqs = [],
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'air',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0.8,
		follow_up = 'wind_atk_1'
	},
	wind_atk_1 = {
		code = 'wind_atk_1',
		name = '',
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads', 'not_final', 'random_target'],
		reqs = [],
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'air',
		random_target = true,
		not_final = true,
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0.8,
	},
	
	fire_cleave = {
		code = 'fire_cleave',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/firecleave.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','aoe'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_burn_new', chance = 0.2, push_characters = true, duration = 2})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'line',
		target_range = 'weapon',
		damage_type = 'fire',
		sfx = [{code = 'flame', target = 'target', period = 'postdamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = [['caster.atk','*0.2'], 0.7],
		damagestat = ['no_stat', '+damage_hp']
	},
	
	fire_burst = {
		code = 'fire_burst',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/firebolt.png"),
		type = 'combat', 
		ability_type = 'spell',
		tags = ['damage','aoe','learnable'],
#		new_syntax = true,
		learn_reqs = [{code = 'trait', trait = 'advanced_spells', check = true}],
		learn_cost = 850,
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_fireburst', duration = 3})], 
		cost = {mp = 8},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'all',
		target_range = 'any',
		damage_type = 'fire',
		sfx = [{code = 'firebolt', target = 'target', period = 'predamage'},{code = 'flame', target = 'target', period = 'postdamage'}], 
		sounddata = {initiate = 'firebolt', strike = null, hit = 'firehit', hittype = 'absolute'},
		value = 0.50
	},
	
	arrowrain = {
		code = 'arrowrain',
		descript = '',
		icon = load("res://assets/images/iconsskills/arrowshower.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','aoe'],
		reqs = [], #{code = 'gear_equiped', param = 'geartype', value = 'bow', check = true}],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_arrowrain', chance = 0.3, duration = 2})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'line',
		target_range = 'any',
		damage_type = 'water',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0.65
	},
	explosivearr = {
		code = 'explosivearr',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/icon_arrow_explode.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [], #{code = 'gear_equiped', param = 'geartype', value = 'bow', check = true}],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_burn_new', push_characters = true, duration = 2})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'fire',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = [['caster.atk','*0.25'],1.3],
		damagestat = ['no_stat', '+damage_hp']
	},
	shadowstrike = {
		code = 'shadowstrike',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/icon_dark.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_sstrike', duration = 2})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'dark',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1.3
	},
	decay = {
		code = 'decay',
		descript = '',
		icon = load("res://assets/images/iconsskills/Acid-spit.png"),
		type = 'combat', 
		ability_type = 'spell',
		tags = ['damage','aoe'],
		reqs = [],
		targetreqs = [],
		effects = [], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'all',
		target_range = 'any',
		damage_type = 'dark',
		sfx = [{code = 'decay', target = 'target_frame', period = 'predamage'}], 
		sounddata = {initiate = null, strike = null, hit = null},
		value = 0.65
	},
	
	mimic_attack = {
		code = 'mimic_attack',
		descript = '',
		icon = load("res://assets/images/iconsskills/AcidBomb.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_disarm1', duration = 3})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'melee',
		damage_type = 'water', 
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1.2
	},
	entangle_enemy = {
		code = 'entangle_enemy',
		descript = '',
		icon = load("res://assets/images/iconsskills/AcidBomb.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_disarm3', duration = 3})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',#?
		target_range = 'any',
		damage_type = 'earth',
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}],#? 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1
	},
	poison_spray = {
		code = 'poison_spray',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'spell',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_poison_new', push_characters = true, duration = 3})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'all',
		target_range = 'any',
		damage_type = 'water',
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = [0.05, 1.0], #second value is questionable
		damagestat = ['no_stat', '+damage_hp']
	},
	poison_bite = {
		code = 'poison_bite',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_poison_new', push_characters = true, duration = 5})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'melee',
		damage_type = 'dark',
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = [0.4, 1.5],
		damagestat = ['no_stat', '+damage_hp']
	},
	bleeding_strike = {#applies debuff: deal 25% bonus damage every turn for 4 turns
		code = 'bleeding_strike',
		descript = '',
		icon = load("res://assets/images/iconsskills/Lich-strike.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','debuff','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_bleed_new', push_characters = true, duration = 4})], 
		cost = {},
		charges = 0,
		combatcooldown = 2,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'weapon',
		damage_type = 'weapon',
		value = ['caster.atk'],
		sfx = [{code = 'debuff', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
	},
	shred = {
		code = 'shred',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
#		effects = [Effectdata.rebuild_template({effect = 'e_s_shred_old', duration = 3})], #if change to new version - Effectdata.rebuild_template_globals({effect = 'e_s_shred2'})
		effects = [Effectdata.rebuild_template_globals({effect = 'e_s_shred2'})], 
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'melee',
		damage_type = 'weapon',
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1.3,
	},
	growl = {
		code = 'growl',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['aoe'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_growl', duration = 3})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'x_random',
		number_rnd_targets = 3,
		target_range = 'any',
		damage_type = 'air',
		sfx = [{code = 'water_attack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0.5,
	},
	magicward = {
		code = 'magicward',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['buff'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_mward'})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'ally',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'weapon',
		sfx = [{code = 'buff', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0,
	},
	windblast = { 
		code = 'windblast',
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage', 'debuff', 'air', 'ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_silence1', duration = 3, chance = 0.5})], 
		cost = {},
		charges = 0,
		combatcooldown = 1,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'x_random',
		number_rnd_targets = 3,
		target_range = 'any',
		damage_type = 'air',
		sfx = [{code = 'debuff', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1.1,
	},
	swipe_en = {
		code = 'swipe_en',
		descript = '',
		icon = load("res://assets/images/iconsskills/Heavy-Strike.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_stun1', duration = 1})], 
		cost = {},
		repeat = 2,
		random_target = true,
		charges = 0,
		combatcooldown = 1,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'melee',
		damage_type = 'normal',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = 'avalanche', strike = null, hit = null, hittype = 'bodyarmor'},
		value = 1.2
	},
	voidslam = {
		code = 'voidslam',
		
		descript = '',
		icon = load("res://assets/images/iconsskills/Attack.png"),
		type = 'combat', 
		ability_type = 'skill',
		tags = ['damage','ads', 'debuff'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_slam', duration = 2})],
		cost = {},
		charges = 0,
		combatcooldown = 0,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'dark',
		sfx = [{code = 'debuff', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 1.0,
	},
	
	light_spell_aoe = {
		code = 'light_spell_aoe',
		descript = '',
		icon = load("res://assets/images/iconsskills/light_spell_aoe.png"),
		type = 'combat', 
		ability_type = 'spell',
		tags = ['damage','light', 'aoe'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_t_holy', duration = 3})], 
		cost = {},
		charges = 0,
		combatcooldown = 1,
		cooldown = 0,
		catalysts = {},
		target = 'enemy',
		target_number = 'all',
		target_range = 'any',
		damage_type = 'light',
		sfx = [{code = 'targetattack', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = 'blade', hit = null},
		value = 0.3
	},
	
	take_position = { #aire unique skill
		code = 'take_position',
		descript = '',
		icon = load("res://assets/images/iconsskills/takeposition.png"),
		type = 'combat', 
		ability_type = 'spell',
		tags = ['buff','support', 'instant'],
		reqs = [],
		targetreqs = [],
		effects = [Effectdata.rebuild_template({effect = 'e_s_takeposition'})], 
		cost = {},
		charges = 0,
		combatcooldown = 5,
		cooldown = 0,
		catalysts = {},
		target = 'self',
		target_number = 'single',
		target_range = 'any',
		damage_type = 'weapon',
		damage = 0,
		sfx = [{code = 'buff', target = 'target', period = 'predamage'}], 
		sounddata = {initiate = null, strike = null, hit = null},
		value = ['0'],
		damagestat = 'no_stat'
	},
	#items
	zephyra_underwear = {
		new_syntax = true,
		code = 'zephyra_underwear',
		descript = '',
		type = 'social',
		ability_type = 'skill',
		reqs = [],
		targetreqs = [],
		effects = [],
		cost = {},
		charges = 0,
		cooldown = 0,
		icon = null,
		tags = [],
		special = 'zephyra_underwear',
	},
	
}



var training_actions = {
	praise = {
		code = 'praise',
		type = 'positive',
		name = '',
		descript = '',
		scene_image = 'praise',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
	},
	reward = {
		code = 'reward',
		type = 'positive',
		name = '',
		descript = '',
		scene_image = 'reward',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'disposition', check = ['weak', 'kink'], chance = {fail_mul = 0, resist_mul = 0}},
		],
		reqs = [],
		reqs_trainer = [],
		cost = {gold = 10},
		disposition_affects = ['humiliation']
	},
	dayoff = {
		code = 'dayoff',
		type = 'positive',
		name = '',
		descript = '',
		scene_image = 'day_off',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'always', chance = {fail_mul = 0}},
		],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['social']
	},
	slap = {
		code = 'slap',
		type = 'physical',
		name = '',
		descript = '',
		scene_image = 'slap',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['positive']
	},
	spank = {
		code = 'spank',
		type = 'physical',
		name = '',
		descript = '',
		scene_image = 'spank',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
	},
	whip = {
		code = 'whip',
		type = 'physical',
		name = '',
		descript = '',
		scene_image = 'punish',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['magic']
	},
	scold = {
		code = 'scold',
		type = 'humiliation',
		name = '',
		descript = '',
		scene_image = 'warn',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
	},
	insult = {
		code = 'insult',
		type = 'humiliation',
		name = '',
		descript = '',
		scene_image = 'warn',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['positive']
	},
	kneel = {
		code = 'kneel',
		type = 'humiliation',
		name = '',
		descript = '',
		scene_image = 'kneel',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'disposition', check = ['weak', 'kink'], effect = {loyalty_add = [3, 5]}},
			{type = 'disposition', check = ['resist'], effect = {spirit_add = -3}},
			],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['social']
	},
	shame = {
		code = 'shame',
		type = 'social',
		name = '',
		descript = '',
		scene_image = 'warn',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
	},
	punish = {
		code = 'punish',
		type = 'social',
		name = '',
		descript = '',
		scene_image = 'public_punish',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
	},
	molest = {
		code = 'molest',
		type = 'social',
		name = '',
		descript = '',
		scene_image = 'grope',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'disposition', check = ['weak', 'kink'], effect = {loyalty_add = [3, 5]}},
			{type = 'disposition', check = ['resist'], effect = {spirit_add = [-10, -7]}},
		],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['sexual']
	},
	grope = {
		code = 'grope',
		type = 'sexual',
		name = '',
		descript = '',
		scene_image = 'grope',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['physical']
	},
	strip = {
		code = 'strip',
		type = 'sexual',
		name = '',
		descript = '',
		scene_image = 'strip',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['social']
	},
	rape = {
		code = 'rape',
		type = 'sexual',
		name = '',
		descript = '',
		scene_image = 'grope',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [],
		showup_reqs = [],
		disposition_affects = ['positive','humiliation'],
		cost = {},
	},
	edge = {
		code = 'edge',
		type = 'sexual',
		name = '',
		descript = '',
		scene_image = 'abuse',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'disposition', check = ['resist', 'neutral'], effect = {spirit_add = [-25, -15]}},
			{type = 'disposition', check = ['kink'], effect = {loyalty_add = [5, 6]}},
		],
		reqs = [],
		reqs_trainer = [{code = 'unique', value = 'amelia'}],
		cost = {},
	},
	publicuse = {
		code = 'publicuse',
		type = 'sexual',
		name = '',
		descript = '',
		scene_image = 'public_use',
		scene_text = '',
		result_text = {},
		bonus_changes = [
			{type = 'always', effect = {loyalty_add = [3, 5]}},
			{type = 'disposition', check = ['resist', 'neutral', 'weak'], effect = {spirit_add = [-50, -40]}},
		],
		reqs = [],
		reqs_trainer = [],
		cost = {},
		disposition_affects = ['positive', 'humiliation']
	},
	mindread = {
		code = 'mindread',
		type = 'magic',
		name = '',
		descript = '',
		scene_image = 'mindread',
		scene_text = '',
		result_text = {},
		bonus_changes = [{type = 'always', effect = {loyalty_mul = 0, spirit_mul = 0}},],
		reqs = [],
		reqs_trainer = [{code = 'stst', stat = 'mastery_mind', operant = 'gte', value = 1}],
		cost = {mana = 3},
	},
	influence = {
		code = 'influence',
		type = 'magic',
		name = '',
		descript = '',
		scene_image = 'sedation',
		scene_text = '',
		result_text = {},
		bonus_changes = [],
		reqs = [],
		reqs_trainer = [{code = 'stst', stat = 'mastery_mind', operant = 'gte', value = 2}],
		cost = {mana = 5},
		disposition_affects = [['positive', 'physical', 'humiliation', 'social', 'sexual']]
	},
	stronginfluence = {
		code = 'stronginfluence',
		type = 'magic',
		name = '',
		descript = '',
		scene_image = 'sedation',
		scene_text = '',
		result_text = {},
		bonus_changes = [{type = 'always', chance = {success_mul = 2}},],
		reqs = [],
		reqs_trainer = [{code = 'stst', stat = 'mastery_mind', operant = 'gte', value = 4}],
		cost = {mana = 10},
	},
	mindcontrol = {
		code = 'mindcontrol',
		type = 'magic',
		name = '',
		descript = '',
		scene_image = 'mindcontrol',
		scene_text = '',
		result_text = {},
		bonus_changes = [{type = 'always', effect = {loyalty_mul = 2, spirit_mul = 2}},],
		reqs = [],
		reqs_trainer = [{code = 'stst', stat = 'mastery_mind', operant = 'gte', value = 6}],
		cost = {mana = 25},
	},
	
}

var training_categories = {
	positive = {
		name = '',
		description = '',
		icon = "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/like.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'headgirl', effect = {loyalty_mul = 1.25}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
		]
	},
	physical = {
		name = '',
		description = '',
		icon = "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/whip.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'sadist', effect = {spirit_mul = 1.2, loyalty_mul = 1.2}},
			{type = 'trainer_class', check = 'headgirl', effect = {loyalty_mul = 1.15}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
			]
	},
	humiliation = {
		name = '',
		description = '',
		icon = "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/knees.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'headgirl', effect = {loyalty_mul = 1.15}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
		]
	},
	social = {
		name = '',
		description = '',
		icon = "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/group.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'headgirl', effect = {loyalty_mul = 1.15}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
			]
	},
	sexual = {
		name = '',
		description = '',
		icon = "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/heart.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'succubus', chance = {resist_add = -30, fail_add = -30}},
			{type = 'trainer_class', check = 'true_succubus', chance = {resist_add = -30, fail_add = -30}},
			{type = 'trainer_class', check = 'sadist', effect = {spirit_mul = 1.2, loyalty_mul = 1.2}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
			]
	},
	magic = {
		name = '',
		description = '',
		icon =  "res://assets/Textures_v2/CHAR_INFO/loyalty/Assigned trainer/icons_40x40/magic effect.png",
		bonus_changes = [
			{type = 'trainer_class', check = 'master', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'renown_royalty', chance = {success_add = 20, crit_success_add = 20}},
			{type = 'trainer_class', check = 'director', effect = {spirit_mul = 0.8}},
			{type = 'trainer_class', check = 'trainer', result = ['success', 'crit_success'], effect = {loyalty_add = 3}},
			{type = 'trainer_status', check = 'mentor', result = ['success', 'crit_success'], effect = {spirit_add = 3}},
			{type = 'stat', stat = 'tame_factor', operant = 'gte', check = 6, effect = {spirit_mul = 0.5}},
			]
	},
}

var masteries = {
	warfare = {
		type = 'combat',
		icon = 'mastery_warfare',
		background = 'mastery_warfare',
		maxlevel = 5,
		passive = {atk = 1, armor = 2},
		level1 = {combat_skills = ["draw_blood"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["sunder"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["cleave"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["strike_through"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["execution"], explore_skills = [], traits = [], action = []},
	},
	protection = {
		type = 'combat',
		icon = 'mastery_protection',
		background = 'mastery_protection',
		maxlevel = 5,
		passive = {hpmax = 3, armor = 3},
		level1 = {combat_skills = ["taunt"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["disarm_enemy"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["provocation"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["stonewall"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["last_stand"], explore_skills = [], traits = [], action = []},
	},
	stealth = {
		type = 'combat',
		icon = 'mastery_stealth',
		background = 'mastery_stealth',
		maxlevel = 5,
		passive = {evasion = 5},
		level1 = {combat_skills = ["hide"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["dip_poison"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["backkick"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["assassinate"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["devastation"], explore_skills = [], traits = [], action = []},
	},
	marksmanship = {
		type = 'combat',
		icon = 'mastery_marksmanship',
		background = 'mastery_marksmanship',
		maxlevel = 5,
		passive = {atk = 1, hitrate = 5},
		level1 = {combat_skills = ["strafe"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["trap"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["ensnare"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["bolt_trap"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["arrow_hail"], explore_skills = [], traits = [], action = []},
	},
	leadership = {
		type = 'combat',
		icon = 'mastery_leadership',
		background = 'mastery_leadership',
		maxlevel = 5,
		passive = {hpmax = 3, mpmax = 3},
		level1 = {combat_skills = ["first_aid"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["inspire","leadersmark"], explore_skills = [], traits = [], action = []},#sic, change name to huntersmark
		level3 = {combat_skills = [], explore_skills = ["intimidating_presence"], traits = [], action = []},
		level4 = {combat_skills = [], explore_skills = [], traits = ["stun_immunity"], action = []},
		level5 = {combat_skills = ["rally"], explore_skills = [], traits = [], action = []},
	},

	fire = {
		type = 'spell',
		icon = 'mastery_fire',
		background = 'mastery_fire',
		maxlevel = 6,
		passive = {atk = 1, damage_mod_fire = 0.05},
		level1 = {combat_skills = ["firearr"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["bloodboil"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = [], explore_skills = ["flame_sphere"], traits = [], action = []},
		level4 = {combat_skills = ["fire_shield"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["magma_blast"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = ["inferno"], explore_skills = [], traits = [], action = []},
	},
	water = {
		type = 'spell',
		icon = 'mastery_water',
		background = 'mastery_water',
		maxlevel = 6,
		passive = {mdef = 2, damage_mod_water = 0.04, damage_mod_heal = 0.04},
		level1 = {combat_skills = ["rejuvenation"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["water_edge"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["water_shield"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["frost_prison","clarity"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["blizzard"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = ["hailstorm"], explore_skills = [], traits = [], action = []},
	},
	earth = {
		type = 'spell',
		icon = 'mastery_earth',
		background = 'mastery_earth',
		maxlevel = 6,
		passive = {armor = 3, damage_mod_earth = 0.04},
		level1 = {combat_skills = ["earth_shield"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["acidbomb"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = [], explore_skills = ["natures_gift"], traits = [], action = []},
		level4 = {combat_skills = ["overgrowth"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["earthquake"], explore_skills = ['teleport'], traits = [], action = []},
		level6 = {combat_skills = ["disintegrate"], explore_skills = [], traits = [], action = []},
	},
	air = {
		type = 'spell',
		icon = 'mastery_air',
		background = 'mastery_air',
		maxlevel = 6,
		passive = {evasion = 3, damage_mod_air = 0.05, critchance = 0.06},
		level1 = {combat_skills = ["wind_blade"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["lightning"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["haste"], explore_skills = ["wind_whispers"], traits = [], action = []},
		level4 = {combat_skills = ["chain_lightning"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["air_shield"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = ["tempest","eyeofthestorm"], explore_skills = [], traits = [], action = []},
	},
	light = {
		type = 'spell',
		icon = 'mastery_light',
		background = 'mastery_light',
		maxlevel = 6,
		passive = {damage_mod_heal = 0.05, damage_mod_light = 5},
		level1 = {combat_skills = ["healing"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["blessing"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["resurrect","elemental_protection"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["pacify"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["radiance"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = ["mass_resurrect"], explore_skills = [], traits = [], action = []},
	},
	dark = {
		type = 'spell',
		icon = 'mastery_dark',
		background = 'mastery_dark',
		maxlevel = 6,
		passive = {matk = 2, damage_mod_dark = 5},
		level1 = {combat_skills = ["darkness"], explore_skills = [], traits = [], action = []},
		level2 = {combat_skills = ["black_tendrils"], explore_skills = [], traits = [], action = []},
		level3 = {combat_skills = ["malediction"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = ["devour_magic"], explore_skills = [], traits = [], action = []},
		level5 = {combat_skills = ["veil"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = ["skill_void"], explore_skills = [], traits = [], action = []},
	},
	mind = {
		type = 'spell',
		icon = 'mastery_mind',
		background = 'mastery_mind',
		maxlevel = 6,
		passive = {mpmax = 3, damage_mod_mind = 5},
		level1 = {combat_skills = [], explore_skills = [], traits = [], action = ["mindread"]},
		level2 = {combat_skills = ["mindblast"], explore_skills = [], traits = [], action = ["influence"], },
		level3 = {combat_skills = ["invigorate"], explore_skills = [], traits = [], action = []},
		level4 = {combat_skills = [], explore_skills = [], traits = [], action = ["stronginfluence"]},
		level5 = {combat_skills = ["mindshatter"], explore_skills = [], traits = [], action = []},
		level6 = {combat_skills = [], explore_skills = [], traits = [], action = ["mindcontrol"]},
	},
}


func get_template(id, caster):
	var tres = Skilllist[id].duplicate(true)
	#process variations
	if tres.has('variations'):
		for line in tres.variations:
			if caster.checkreqs(line.reqs):
				if line.has('replace'): #total replacement
					tres = get_template(line.replace, caster)
					break
				if line.has('add'):
					for arg in line.add:
						tres[arg] = tres[arg] + line.add[arg]
				if line.has('set'):
					for arg in line.set:
						tres[arg] = line.set[arg]
	#process type_change
	if !(tres.has('new_syntax') and tres.new_syntax == true): 
		var ss = ResourceScripts.scriptdict.class_sskill_legacy.new()
		ss.createfromskill(tres)
		tres = ss.convert_to_new_template()
	#process charges
	if tres.has('charges'):
		tres.charges = get_charges(tres, caster)
	#load icon
	if tres.icon is String:
		tres.icon = input_handler.loadimage(tres.icon, 'icons') #not get_icon or load for the sake of user: pathes
	return tres


func get_charges(skill, caster):#template, object
	var res = 0
	if skill.has('charges'): 
		if typeof(skill.charges) == TYPE_ARRAY:
			res = round(caster.calculate_number_from_string_array(skill.charges))
		elif typeof(skill.charges) == TYPE_INT:
			res = skill.charges
		else:
			print('error in skill template %s' % [skill.code])
		if caster.has_status('communicative'):
			res += 1
	return res


func _ready():
	for s in training_actions:
		var tmp = training_actions[s]
		if tmp.name == '':
			tmp.name = 'ACTION' + s.to_upper()
		if tmp.descript == '':
			tmp.descript = 'ACTION' + s.to_upper() + 'DESCRIPT'
		if tmp.scene_text == '':
			tmp.scene_text = 'ACTION' + s.to_upper() + 'SCENETEXT'
	for s in training_categories:
		var tmp = training_categories[s]
		if tmp.name == '':
			tmp.name = 'ACTIONTYPE' + s.to_upper()


